
- azure_rm_virtualmachine:
    resource_group: "{{ resource_group_name }}"
    name: "{{ name }}"
    vm_size: "{{ flavor }}"
    admin_username: "{{ user_name}}"
    ssh_password_enabled: false
    ssh_public_keys:
      - path: /home/{{ user_name}}/.ssh/authorized_keys
        key_data: "{{public_key}}"
    network_interfaces: "{{network_interface_name}}"
      image:
        offer: "{{ os_distro }}"
        sku: "{{ os_version }}"
        version: latest
        publisher: "{{publisher_name}}"
    register: vm_output
